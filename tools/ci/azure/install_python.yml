steps:
- powershell: |
    Start-BitsTransfer -Source https://www.python.org/ftp/python/3.6.8/python-3.6.8-amd64.exe  -Destination python_installer.exe
    $hash = (Get-FileHash python_installer.exe).Hash.ToLower()
    $expectedHash = "96088a58b7c43bc83b84e6b67f15e8706c614023dd64f9a5a14e81ff824adadc"
    if ($hash.Equals($expectedHash)) {
      Write-Host "python_installer.exe hash verified"
    } else {
      Throw "python_installer.exe hash mismatch, got $hash, expected $expectedHash"
    }
    & .\python_installer.exe /passive TargetDir=C:\Python36
    Write-Host "##vso[task.prependpath]C:\Python36"
    Write-Host "##vso[task.prependpath]C:\Python36\Scripts"
  displayName: 'Install Python (Windows)'
  condition: and(succeeded(), eq(variables['Agent.OS'], 'Windows_NT'))
